# cwd-merchant-referral
Пример создания реферальной системы на базе платформы CrowdWiz, написан на Python3
*Программное обеспечение преодставляется как есть. Вся ответственность за его использование лежит на вас. Внимательно конфигурируйте и следуйте инструкциям.*

Необходимые библиотеки:
```
pip3 install wheel 
pip3 install peewee psycopg2-binary tornado requests 
pip3 install -U requests[socks]
pip3 --no-cache-dir install crowdwiz
```

В качестве интерфейса для баз данных используется PeeWee он не зависит от движка баз данных, в примере использется локальная база SQLite, но можно и Postgres.

В комплекте 3 файла:
1) config.py - конфигурационный файл, в нём хранятся все настройки и в нём нужно указать логин аккаунта магазина, а также его активный приватный ключ и приватный ключ примечаний, также там нужно указат ключ телеграм бота. Бота можно зарегистрировать через @BotFather. Также в конфиге есть параметры подключения к базе данных и настройка реферальной системы и сумма минимального платежа (полезно для лендингов с моно-продуктами).
2) models.py - описывает 2 таблицы, в одной хранятся параметры бота, во второй история преводов.
3) server.py - сервер реферальных автовыплат.

Запуск бота:
- Сначала нужно заполнить config.py (он с комментариями)
- Затем запустить файл python3 models.py он создаст необходимые базы данных и таблицы
- Затем запускаем python3 server.py

Бот анализирует историю переводов на указанный в конфигурационном файле аккаунт и определяет от кого пришла оплата и осуществляет выплату реферальных вознагарждений по структуре. При этом он может отправлять уведомления об оплатах в телеграм.
По умолчанию производятся реферальные выплаты от любой суммы поступившей на аккаунт магазина. Так что не используйте в качестве аккаунта магазина свой основной аккаунт.
Бот обрабатывает только платежи в базовой валюте блокчейна CWD, в ней же выплачивает вознаграждения.
